
<RadSideDrawer tkExampleTitle tkToggleNavButton >
    <GridLayout tkDrawerContent rows="40, *" class="sideStackLayout">
       
        <Label row="0" (touch)='ontouch($event)'  text="Catégories  &#xf104;" class='fas sideTitleStackLayout' (tap)="onCloseDrawerTap()"></Label>
        <ListView row="1"  class="list-group" [items]="allCategories "  >
  				  <ng-template let-k="item" let-i='index' >
            		<StackLayout  class="sideStackLayout ">
           		     <Label textWrap='true'    (touch)='ontouch($event)'  *ngIf='k!=filter' text="{{k}}" class="sideLabel list-group-item" (tap)="selectFilter(k)"></Label>
           		    
           		     <Label textWrap='true'   (touch)='ontouch($event)'     *ngIf='k==filter' text="{{k}}" class="sideLabelActive list-group-item" (tap)="selectFilter(k) "></Label>
           		    </StackLayout> 
                  </ng-template>
        </ListView>
     
    </GridLayout>
 
    <ScrollView  tkMainContent    >
 <GridLayout rows="auto,auto,auto,335,auto,*,*">
           <!-- StackLayout android:cursorVisible="false" row="0" margin="5,0,0,0"  colSpan="2" 	backgroundColor="rgba(0,0,0, 0.4)">
            
              <!-- StarRating  isindicator="false" (valueChange)="setScore($event)"   android:scaleX=".3" android:scaleY=".3"
                horizontalAlignment="center" verticalAlignment="center"  [value]="value" ></StarRating>
  				<Label text="{{value}}"></Label>
           
           </StackLayout-->
 <GridLayout    row="0" columns="auto,auto,*" rows='35,35' >
       <Label  (touch)='ontouch($event)'    row='0'  margin="7,0,0,5" text="Catégories &#xf02b;" col='0'  (tap)="openDrawer()" class=" fas cat"></Label>
            
        <Label row='0' margin='5,0,0,5' col="1" text='{{filter}}' class="fas filter">  </Label>
        
         <Label row='1' margin="10,5,0,5" text="Trier par &#xf0dc;" col='0' class=" fas cat"></Label>

		<StackLayout orientation="horizontal"  row="1" col="1">
  			<Label  *ngIf="orderby!='newest'"text="Récent"  class='label' (tap)="sort('newest')"></Label>
  			<Label *ngIf="orderby=='newest'" text="Récent"  class='labelActive'></Label>
  			
  			<Label *ngIf="orderby!='feedback'" text="Evaluation"  class='label' (tap)="sort('feedback')"></Label>
  			<Label *ngIf="orderby=='feedback'" text="Evaluation"  class='labelActive' ></Label>
  			
  			<Label *ngIf="orderby!='price'" text="Prix"  class='label' (tap)="sort('price')"></Label>
	     	<Label *ngIf="orderby=='price'" text="Prix"  class='labelActive' ></Label>
	   
	    </StackLayout>
 </GridLayout>

   <StackLayout row="1" margin="5,0,5,0"  colSpan="2" backgroundColor="#D0D0D0" height="3"></StackLayout>
 
 
 
 <Label  (tap)="reloading()"  (touch)="ontouch($event)"  row='2'  *ngIf='!loading && reload' class="reload">
        <FormattedString>
            <Span text="Problème de connexion... "></Span>
            <Span text="réessayer"  color="#FFA500" class="bold" ></Span>
        </FormattedString>
  </Label>
 
 
 <StackLayout row ="2">
  <ActivityIndicator  	 *ngIf="loading" color='#FFA500' rowSpan="2" [busy]="loading"></ActivityIndicator>
 </StackLayout>
     		
 <StackLayout   [visibility]="!reload && !loading ?'visible':'collapse'" row='3'  >
    <Carousel #myCarousel debug="true" [items]="stores" height="90%" width="100%" color="#fff"(pageChanged)="myChangePageEvent($event)" 
                    indicatorAnimation="swap"  indicatorColor="#FFA500" indicatorOffset="0,-10" showIndicator="true" indicatorColorUnselected="#eeeeee" >
   
        <CarouselItem *ngFor="let item of stores"  >
            <GridLayout (touch)='ontouch2($event)'  rows="auto,auto,auto" (tap)="gotoStore(item._id)" >
    		             
    		
                <Image loadMode="async"   row="0" 	 backgroundColor='rgba(0,0,0, 0.3)'  src="{{item.banner}}" class="pic" stretch="aspectFill"></Image>
                <Label   color='#333333' row='1' [text]="item._id" fontSize="14" margin="5,0,0,5" ></Label>
                <AbsoluteLayout row="2"  >
                    <StackLayout left="-70" top="-10"  android:cursorVisible="false"  >
            
              		<StarRating filledColor="#FFA500"  isindicator="true"  android:scaleX=".4" android:scaleY=".4"
                		horizontalAlignment="center" verticalAlignment="center"  [value]="item._source.ratingsum/item._source.ratingcount" ></StarRating>
  				    </StackLayout>
  				    <Label color='#333333' fontSize="10" left ="15" top="30" text="({{item._source.ratingcount}} votes)"></Label>
  				 
           		</AbsoluteLayout>
           		
            </GridLayout>
            
        </CarouselItem>
    </Carousel>
     
 </StackLayout>

   
    <StackLayout row="4"  colSpan="2" backgroundColor="#D0D0D0" height="3"></StackLayout>
   
    
     <StackLayout row ="6">
  <ActivityIndicator  	 color='#FFA500' rowSpan="2" [busy]="loading3 && !loading2"></ActivityIndicator>
 </StackLayout> 
    
      <RadListView   [visibility]="!reload && !loading3 ?'visible':'collapse'"  row="6" [items]="articlescats | keyvalue ">
      <ng-template let-c="item"   >
      	<GridLayout rows='auto,*,auto'  >
      	<Label margin='5,12,0,12' row="0"[text]="c.key" class="sideLabel2" ></Label>
      	<GridLayout row="1" >
      	<RadListView   [items]="c.value"  >
      		 <ng-template   let-a="item" >
      			<GridLayout  (touch)='ontouch2($event)'     (doubleTap)="gotoArticle(a._id, a._source.storetitle )">
      			<Image loadMode="async"   [src]='mainpics[a._id]' class='articlepic' stretch="aspectFill" (touch)="display(a._id)"  ></Image>
      			
      			<AbsoluteLayout width="170"  >
      			      		     <ActivityIndicator color='#FFA500' rowSpan="3" *ngIf='a.loadingcart==1' [busy]="a.loadingcart==1" ></ActivityIndicator>
      			
      			<Label (touch)='ontouch3($event)' (tap)="addToCart(a)"  [visibility]="disp[a._id] ?'visible':'collapse'"
      					left="55" top="5" class='panier fas'>
						<FormattedString>
										<Span text='Panier &#xf217;' ></Span>
										<Span  *ngIf=" a.loadingcart==2 " text='&#xf00c;'></Span>
										<Span  *ngIf=" a.loadingcart==3  " text="&#xf05e;"></Span>
      					</FormattedString>
      	         </Label>
      	           <Label left="0" top="40" row='0' id="globeItemNavigation"  class="alert" *ngIf='fullcartwarning && a.loadingcart==3 ' text="Le panier est plein" ></Label> 
      	        
      		<GridLayout left='0' top='55' rows="auto,auto,auto,auto"    class="title" [visibility]="disp[a._id] ?'visible':'collapse'" >
            
                <TextView  row='0'   editable="false" class='titlea' text="{{a._source.title}}">
                </TextView>
             
				  <StackLayout   row="1"  width="85" horizontalAlignment="center">
      	           <StackLayout      margin='-20,-75,0,-75' android:cursorVisible="false"  >
      	           
                 <StarRating filledColor="#FFA500" isindicator="true"  android:scaleX=".3" android:scaleY=".3"  [value]="a._source.ratingsum/a._source.ratingcount" ></StarRating>
                </StackLayout>
                 <Label fontSize="10" margin='-20,0,0,0' text="({{a._source.ratingcount}} votes)"></Label>
                
                </StackLayout>
                
                <Label  textWrap="true"  (touch)='ontouch3($event) ;gotoStore(a._source.storetitle)' class='storetitle' row="2" text='Magasin: {{a._source.storetitle}}'></Label>
      			<Label class='price' row="3"   text=' {{a._source.price}} D.A'  ></Label>
		    	 </GridLayout>
       	     </AbsoluteLayout>
       		</GridLayout>
      			<!-- StarRating style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;" emptyColor="black"  isindicator='true'filledColor="red" value="3" max="5"></StarRating-->
      		 
      	  
     		 </ng-template>	
     
     		
     		<ListViewLinearLayout tkListViewLayout scrollDirection="Horizontal" spanCount="1"></ListViewLinearLayout>
      	</RadListView>
      	</GridLayout>
      	   <GridLayout row="2"   rows='*,auto'>
      	    <StackLayout row="1" margin="5,10,5,10"  colSpan="2" backgroundColor="#00BFFF" height="2"></StackLayout>
      	      
      		<Label row="0" class="fas angle" text='  &#xf105;&#xf105;&#xf105;' (touch)='ontouch3($event)'  (tap)="selectFilter(c.key);" ></Label>
      		
      		</GridLayout>
      	</GridLayout>
      </ng-template>
      </RadListView>     
       
       
 <StackLayout row ="5">
  <ActivityIndicator  	  color='#FFA500' rowSpan="2" [busy]="loading2"></ActivityIndicator>
 </StackLayout> 
      
 <GridLayout [visibility]="!reload && !loading2 ?'visible':'collapse'"   row ="5" rows="auto, auto, *">
       
      <Label margin='5,12,0,12' row="0" text="Nouveauté" class="sideLabel2" ></Label>
       
       
       <GridLayout row="1">
      <RadListView     [items]="articles">
      
      		 <ng-template  tkListItemTemplate let-a="item" class="itemStackLayout" >
      		
      		    <GridLayout  (touch)='ontouch2($event)'    (doubleTap)="gotoArticle(a._id, a._source.storetitle )"     >
      			<Image  loadMode="async"  [src]='mainpics[a._id]' class='articlepic' stretch="aspectFill" (touch)="display(a._id)"  ></Image>
      			
      			<AbsoluteLayout  width="170" >

							      <ActivityIndicator color='#FFA500' rowSpan="3" *ngIf='a.loadingcart==1' [busy]="a.loadingcart==1" ></ActivityIndicator>
				       			
      			<Label (touch)="ontouch3($event)" (tap)="addToCart(a)"  [visibility]="disp[a._id] ?'visible':'collapse'"
      					left="55" top="5" class='panier fas'>
						<FormattedString>
										<Span text='Panier &#xf217;' ></Span>
										<Span  *ngIf=" a.loadingcart==2 " text='&#xf00c;'></Span>
										<Span  *ngIf=" a.loadingcart==3  " text="&#xf05e;"></Span>
      					</FormattedString>
      	         </Label>
      	         
      	         <Label left="0" top="40" row='0' id="globeItemNavigation"  class="alert" *ngIf='fullcartwarning && a.loadingcart==3 ' text="Le panier est plein" ></Label> 
      	         
      		   <GridLayout left='0' top='55' rows="auto,auto,auto,auto"    class="title" [visibility]="disp[a._id] ?'visible':'collapse'" >
            
              <TextView  row='0'   editable="false" class='titlea' text="{{a._source.title}}">
        
  				  
               </TextView>
                <StackLayout   row="1"  width="85" horizontalAlignmnt="center">
      	           <StackLayout   margin='-20,-75,0,-75' android:cursorVisible="false"  >
      	           
                 <StarRating filledColor="#FFA500" isindicator="true"  android:scaleX=".3" android:scaleY=".3"  [value]="a._source.ratingsum/a._source.ratingcount" ></StarRating>
                </StackLayout>
                 <Label fontSize="10" margin='-20,0,0,0' text="({{a._source.ratingcount}} votes)"></Label>
                
                </StackLayout>
               <Label  textWrap="true"   (touch)="ontouch3($event); gotoStore(a._source.storetitle);" class='storetitle' row="2" text='Magasin: {{a._source.storetitle}}'></Label>
      			<Label class='price' row="3"   text=' {{a._source.price}} D.A'  ></Label>
			   </GridLayout>
      			</AbsoluteLayout>
      			<!-- StarRating style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;" emptyColor="black"  isindicator='true'filledColor="red" value="3" max="5"></StarRating-->
      		  </GridLayout>
      		 
     		 </ng-template>	
     
     		<ListViewLinearLayout tkListViewLayout scrollDirection="Horizontal" spanCount="1"></ListViewLinearLayout>
      	</RadListView>
     </GridLayout>
       <StackLayout row="2" margin="5,10,5,10"  colSpan="3" backgroundColor="#00BFFF" height="2"></StackLayout>
      	
   </GridLayout>
   </GridLayout> 
           </ScrollView>

</RadSideDrawer>
