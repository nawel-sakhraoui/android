
 <form name="form" (ngSubmit)="f.form.valid && addDelivery()" #f="ngForm" novalidate>

<table class="table container ">
  <thead class="thead-light">
    <tr>
      <th scope="col">#</th>
      <th scope="col">Title</th>
      <th scope="col">Villes</th>
      <th scope="col">Categories</th>
      <th scope='col'>weight</th>
      <th scope='col'>Phone</th>
      <th scope="col">price</th>
      <th scope="col">available</th>
    </tr>
  </thead>


  
  <tbody>
  
  <tr>
    <th scope="row"  > <a class="fa fa-plus" (click)='add=!add'></a> </th>
     
      <td *ngIf="add">
      		 <input type="text" class="form-control" name="title" [(ngModel)]="newDelivery.title" #title="ngModel" maxlength='50'>
              <div *ngIf="title.invalid && (title.dirty || title.touched)" class="alert alert-danger">
              <div *ngIf="f.submitted && title.hasError('required')" class="help-block"> required</div>
             </div>
      </td>
      <td *ngIf="add">
      		  <ngx-select-dropdown [multiple]="true"    [(value)]="newDelivery.villes" [config]="villeconfig" [options]="villes" required ></ngx-select-dropdown>
             <div *ngIf="f.submitted && !newDelivery.villes" class="help-block alert alert-danger"> required</div>
             	
             
      
      </td>
      <td *ngIf="add">
      		  <ngx-select-dropdown [config]="config" [options]="categories" 
          		[(value)]="newDelivery.categories" [multiple]="true" ></ngx-select-dropdown>     
       		   <div *ngIf="f.submitted && !newDelivery.categories" class="help-block alert alert-danger"> required</div>
      
      
      </td>
           <td *ngIf="add">
      			<input type="number" step="1"  name="weight" [(ngModel)]="newDelivery.weight" #weight="ngModel" required/>
  		
  				<span class="input-group-addon" style="display:inline;">kg</span>
				<div *ngIf="weight.invalid && (weight.dirty || weight.touched)" class="alert alert-danger">
				pattern issue 
				
           		 <div *ngIf="f.submitted && weight.hasError('required')" class="help-block"> required</div>
            	
            </div>
      </td>
      
     
      <td *ngIf="add">
      		 <input  class="form-control"  name="phone" [(ngModel)]="phones"  required #phone="ngModel" />    
            <div *ngIf="phone.invalid && (phone.dirty || phone.touched)" class="alert alert-danger">
        	
        	 <div *ngIf="f.submitted && phone.hasError('required')" class="help-block"> required</div>
            </div> 
      </td>
       <td *ngIf="add">
      			<input type="number" step="0.01"  name="price" [(ngModel)]="newDelivery.price" #price="ngModel" required/>
  		
  				<span class="input-group-addon" style="display:inline;">D.A</span>
				<div *ngIf="price.invalid && (price.dirty || price.touched)" class="alert alert-danger">
				pattern issue 
				
           		 <div *ngIf="f.submitted && price.hasError('required')" class="help-block"> required</div>
            	
            </div>
      </td>
      
    
       <td *ngIf="add" >  <button class="btn btn-info " [disabled]='loading' > save <span *ngIf='loading' class='fa fa-spinner'></span>  </button>

		</td>
   </tr>
    <tr *ngFor=' let del of deliveries|paginate: { id: "server", itemsPerPage: size, currentPage: page, totalItems: total}  ; let i = index  ' [attr.data-index]="i"  >
      <th scope="row"  > {{del._id}} </th>
      <td>{{del._source.title}}</td>
      <td><li class='list-group-item' *ngFor='let com of del._source.villes'>{{com.name}}</li></td>
      <td><li class='list-group-item' *ngFor='let cat of del._source.categories'>{{cat}}</li></td>
      <td>{{del._source.weight}}<span class="input-group-addon" style="display:inline;">kg</span> </td> 
      
        <td>
  		 
  		    <tr *ngIf='!editDelivery[del._id]' > <span *ngFor='let d of del._source.phone'> {{d}} </span> </tr>
         
	
		<tr *ngIf='editDelivery[del._id]' >    <input   class="form-control"  name="phone" [(ngModel)]="del._source.phone"  #phone="ngModel" />    
           </tr> 
  	     	 <a class="btn fa fa-pencil"  *ngIf='!editDelivery[del._id]' style='display:inline-block;' (click)='editingDel(del._id, i )'> </a>
         	 <a class="btn fa fa-save"  *ngIf='editDelivery[del._id]' style='display:inline-block ;margin-right:5px; ' (click)='savingDel(del._id, del._source.phone )'></a>
			 <a class="btn fa fa-remove"  *ngIf='editDelivery[del._id]' style='display:inline-block; ' (click)='removingDel(del._id, i )'></a>
		  
  	        
  	 </td>
      
      
      <td>{{del._source.price}}<span class="input-group-addon" style="display:inline;">D.A</span> </td> 
      <!-- td><button (click)='remove(del._id, i ); 'class='btn btn-link fa fa-remove' [disabled]='loading2'><span *ngIf='loading2' class='fa fa-spinner'></span></button></td>
        -->
    
     <td>
  		 
  		      <span *ngIf='!editAvailable[del._id]' ><span *ngIf= "del._source.available">Active</span> 
            						  <span *ngIf= "!del._source.available">Disable</span>
            						  </span>
         
		    <label *ngIf='editAvailable[del._id]' class="radio-inline"><input type="radio" name="optradio"  [(ngModel)]="del._source.available" [value]="true" checked>active</label>
			<label *ngIf='editAvailable[del._id]' class="radio-inline"><input type="radio" name="optradio"  [(ngModel)]="del._source.available" [value]="false" >disable</label>

		         
  	     	 <a class="btn fa fa-pencil"  *ngIf='!editAvailable[del._id]' style='display:inline-block;' (click)='editingAvailable(del._id, i )'> </a>
         	 <a class="btn fa fa-save"  *ngIf='editAvailable[del._id]' style='display:inline-block ;margin-right:5px; ' (click)='savingAvailable(del._id, del._source.available)'></a>
			 <a class="btn fa fa-remove"  *ngIf='editAvailable[del._id]' style='display:inline-block; ' (click)='removingAvailable(del._id, i )'></a>
		  
  	        
  	 </td>
    
    </tr>
    
  </tbody>
</table>
       </form> 

<div class="has-text-centered" style='float:right; '>
  <a scrollTo href="#top" >
    <div class="spinner" [ngClass]="{ 'hidden': !loading }"></div>
    <pagination-controls (pageChange)="getPage($event)" id="server"></pagination-controls> 
    </a>
</div> 

